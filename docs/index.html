---

title: Simplydrug

keywords: fastai
sidebar: home_sidebar



nb_path: "index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Objective">Objective<a class="anchor-link" href="#Objective"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div align="justify"> Integrative technological breakthroughs are based on effective scientific communication. The development of integrative workflows using the mainstream Software as a service (SaaS) distribution model is usually not feasible for academic labs, small teams, students, and drug discovery enthusiasts. To advance integrative drug discovery, we developed a set of open-source lightweight modular analysis workflows. These workflows describe the early stages of biological assay development and high throughput screening and provide a hands-on introduction to Drug Discovery for everybody with basic knowledge of biology, python programming, or data science. </div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="List-of-notebooks">List of notebooks<a class="anchor-link" href="#List-of-notebooks"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The notebooks are built in a sequence and gradually introduce concepts of experimental design, QC, and data analysis of different biological assays.</p>
<ul>
<li><strong>01a_enzyme_kinetics.ipynb</strong><br>
Topics: enzyme kinetics, enzyme assays, fluorometry, assay variability and confidence intervals, Z-factor, Z-score based normalization, plate heatmap, hit extraction, molecule visualization, importing molecule bioactivity data.</li>
</ul>
<ul>
<li><strong>01b_enzyme_kinetics_chain.ipynb</strong><br>
Topics: Running enzymatic assay for a number of plates, generating screen hit matrix, plot for all the plates in the screen.     </li>
</ul>
<ul>
<li><strong>02a_ion_channel_development.ipynb</strong><br>
Topics: Introduction to ion channels and assay development, ion flux assay normalization, ion channel kinetics time-series.</li>
</ul>
<ul>
<li><strong>02b_ion_channel_cherry_picking.ipynb</strong><br>
Topics: Calcium influx assay, cherry picking, percent of activation or inhibition.      </li>
</ul>
<ul>
<li><strong>02c_ion_channel_dose_response.ipynb</strong><br>
Topics: Introduction to dose-response, Hill equation.   </li>
</ul>
<ul>
<li><strong>03a_yeast_growth_screen.ipynb</strong><br>
Topics: Running yeast growth assay, growth curve, growth score, filtering out aberrant curves.</li>
</ul>
<ul>
<li><strong>03b_yeast_growth_in_chain.ipynb</strong><br>
Topics: Running yeast growth assay for a number of plates, filtering, generating screen hit matrix, plotting all the plates in the screen.     </li>
</ul>
<ul>
<li><strong>03c_yeast_cherry_picking.ipynb</strong><br>
Topics: Running yeast growth assay with different doses of the compounds. Generation of automatic ppt report.</li>
</ul>
<ul>
<li><strong>04a_imaging_screen.ipynb</strong><br>
Topics: High-content screening and image analysis, reporter system, cell viability, systematic errors detection and correction. </li>
</ul>
<ul>
<li><strong>4b_imaging_assay_development.ipynb</strong> 
Topics: Exploration data anslysdis, PCA, Batch effect.</li>
</ul>
<ul>
<li><strong>04c_imaging_dose_response.ipynb</strong><br>
Topics: Activity versus viability, fitting dose-response for imaging data. </li>
</ul>
<ul>
<li><strong>05_xtt_assay.ipynb</strong><br>
Dose-response assay for compound toxicity.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Install">Install<a class="anchor-link" href="#Install"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are several options:</p>
<ol>
<li><p>You can run the notebooks from Binder <link to binder></p>
</li>
<li><p>pip install simplydrug</p>
</li>
<li><p>Clone this repository: git clone <a href="https://github.com/disc04/simplydrug">https://github.com/disc04/simplydrug</a></p>
</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Dependencies">Dependencies<a class="anchor-link" href="#Dependencies"> </a></h2><p>The codebase relies on the following dependencies (tested version provided in parentheses):</p>
<ul>
<li>python (3.6.1)</li>
<li>pubchempy (1.0.4)</li>
<li>scipy (1.4.1)</li>
<li>seaborn (0.10.0)</li>
<li>python-pptx (0.6.18)</li>
<li>wget(3.2)</li>
<li>xlrd (1.2.0)</li>
<li>rdkit (2019.09.3)</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example-usage">Example usage<a class="anchor-link" href="#Example-usage"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div align="justify"> In each experiment, first, we merge numerical data coming from equipment with the plate layout (descriptors). We describe the experimental design in a layout excel file, and the names of the excel sheets become the names of the columns in a final data table. Each excel sheet contains a table with dimensions of the experiment plate (usually 96 or 384-well plates) and represents some aspect of the layout  -  well ID, treatment, cell density, compound ID, compound concentration, etc.</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div align="justify"> The layout file must contain sheets named  'Well' and 'Status'. The 'Well' table lists well IDs, and the 'Status' can contain either 'Sample', 'Positive' or 'Negative' control, or 'Reference' values. 'Reference' wells are excluded from calculations. The function add_layout merges measurements and layout by the 'Well' column.</div>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">simplydrug.core</span> <span class="k">as</span> <span class="nn">sd</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">(</span><span class="s1">&#39;hts_notebooks//hts_data//enzyme_kinetics_data1.xlsx&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="mi">0</span><span class="p">))[[</span><span class="s1">&#39;Well&#39;</span><span class="p">,</span><span class="s1">&#39;0s&#39;</span><span class="p">,</span><span class="s1">&#39;120s&#39;</span><span class="p">,</span><span class="s1">&#39;240s&#39;</span><span class="p">,</span> <span class="s1">&#39;360s&#39;</span><span class="p">]]</span>
<span class="n">layout_path</span> <span class="o">=</span> <span class="s1">&#39;hts_notebooks//hts_data//enzyme_kinetics_layout.xlsx&#39;</span>
<span class="n">chem_path</span> <span class="o">=</span> <span class="s1">&#39;hts_notebooks//hts_data//compounds//example_chemicals.csv&#39;</span>
<span class="n">chem_plate</span> <span class="o">=</span> <span class="s1">&#39;ex_plate1&#39;</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">sd</span><span class="o">.</span><span class="n">add_layout</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">layout_path</span><span class="p">,</span> <span class="n">chem_path</span> <span class="o">=</span> <span class="n">chem_path</span><span class="p">,</span> <span class="n">chem_plate</span> <span class="o">=</span> <span class="n">chem_plate</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Added  Well
Added  Status
Added compounds:  ex_plate1 

</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Well</th>
      <th>0s</th>
      <th>120s</th>
      <th>240s</th>
      <th>360s</th>
      <th>Status</th>
      <th>Plate</th>
      <th>Compound_id</th>
      <th>lib_name</th>
      <th>SMILES</th>
      <th>Compound Name</th>
      <th>SecName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A1</td>
      <td>798</td>
      <td>910</td>
      <td>977</td>
      <td>1090</td>
      <td>Negative</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A2</td>
      <td>469</td>
      <td>459</td>
      <td>463</td>
      <td>486</td>
      <td>Positive</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A3</td>
      <td>446</td>
      <td>470</td>
      <td>485</td>
      <td>523</td>
      <td>Sample</td>
      <td>ex_plate1</td>
      <td>Compound_0001</td>
      <td>example_library</td>
      <td>Cc1nn(C)c2nc(C(C)C)cc(C(=O)N3CCN(C(=O)C4CC4)CC...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A4</td>
      <td>532</td>
      <td>581</td>
      <td>632</td>
      <td>710</td>
      <td>Sample</td>
      <td>ex_plate1</td>
      <td>Compound_0002</td>
      <td>example_library</td>
      <td>CCOC(=O)c1c(S(=O)(=O)N2CCOCC2)c(-c2ccccc2)n(-c...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A5</td>
      <td>549</td>
      <td>631</td>
      <td>676</td>
      <td>743</td>
      <td>Sample</td>
      <td>ex_plate1</td>
      <td>Compound_0003</td>
      <td>example_library</td>
      <td>Cn1nc(-c2ccc(C=C(C#N)S(=O)(=O)c3ccc(C(F)(F)F)c...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include image.html style="float: left; margin-right:700px" max-width="950" file="/simplydrug/hts_notebooks/hts_images/index_df.png" %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To check our 384 well plate for systematic errors, we often use heatmap representation:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sd</span><span class="o">.</span><span class="n">hts_heatmap</span><span class="p">(</span><span class="n">df</span> <span class="o">=</span> <span class="n">results</span><span class="p">,</span> <span class="n">layout_path</span> <span class="o">=</span> <span class="n">layout_path</span><span class="p">,</span> <span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;120s&#39;</span><span class="p">],</span> <span class="n">path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include image.html style="float: left; margin-right:700px" max-width="550" file="/simplydrug/hts_notebooks/hts_images/index_heatmap.png" %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div align="justify"> In this plate, most of the readings across the plate are close to the plate average, and four wells with high readings probably represent our hit compounds.</div>
</div>
</div>
</div>
</div>
 

