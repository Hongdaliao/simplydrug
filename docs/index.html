---
layout: default
title: simplydrug
keywords: fastai
sidebar: home_sidebar
nb_path: "index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->


<div class="container" id="notebook-container">
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Welcome-to-simplydrug">Welcome to simplydrug<a class="anchor-link" href="#Welcome-to-simplydrug"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><div align="justify"> To advance scientific communication and integrative drug discovery, we developed a set of open-source based analysis workflows. These workflows describe the early stages of biological assay development and high throughput screening and provide a hands-on introduction to Drug Discovery for everybody with basic knowledge of biology, python programming, or data science. </div></p>
<div>
<p><img src="./hts_notebooks/hts_images/bcdd.png" style="vertical-align:left margin: 30px 30px" width="350"/></p>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="List-of-notebooks">List of notebooks<a class="anchor-link" href="#List-of-notebooks"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The notebooks are built in a sequence and gradually introduce concepts of experimental design, QC, and data analysis of different biological assays.</p>
<ul>
<li><a href="https://github.com/disc04/simplydrug/blob/master/hts_notebooks/01a_enzyme_kinetics.ipynb"><strong>01a_enzyme_kinetics</strong></a><br>
Topics: enzyme kinetics, enzyme assays, fluorometry, assay variability and confidence intervals, Z-factor, Z-score based normalization, plate heatmap, hit extraction, molecule visualization, importing molecule bioactivity data.</li>
</ul>
<ul>
<li><a href="https://github.com/disc04/simplydrug/blob/master/hts_notebooks/01b_enzyme_kinetics_chain.ipynb"><strong>01b_enzyme_kinetics_in_chain</strong> </a><br>
Topics: Running enzymatic assay for a number of plates, generating screen hit matrix, plot for all the plates in the screen.     </li>
</ul>
<ul>
<li><a href="https://github.com/disc04/simplydrug/blob/master/hts_notebooks/02a_ion_channel_development.ipynb"><strong>02a_ion_channel_development</strong> </a><br>
Topics: Introduction to ion channels and assay development, ion flux assay normalization, ion channel kinetics time-series.</li>
</ul>
<ul>
<li><a href="https://github.com/disc04/simplydrug/blob/master/hts_notebooks/02b_ion_channel_cherry_picking.ipynb"><strong>02b_ion_channel_cherry_picking</strong></a><br>
Topics: Calcium influx assay, cherry picking, percent of activation or inhibition.      </li>
</ul>
<ul>
<li><a href="https://github.com/disc04/simplydrug/blob/master/hts_notebooks/02c_ion_channel_dose_response.ipynb"><strong>02c_ion_channel_dose_response</strong></a><br>
Topics: Introduction to dose-response, Hill equation.   </li>
</ul>
<ul>
<li><a href="https://github.com/disc04/simplydrug/blob/master/hts_notebooks/03a_yeast_growth_screen.ipynb"><strong>03a_yeast_growth_screen</strong></a><br>
Topics: Running yeast growth assay, growth curve, growth score, filtering out aberrant curves.</li>
</ul>
<ul>
<li><a href="https://github.com/disc04/simplydrug/blob/master/hts_notebooks/03b_yeast_growth_in_chain.ipynb"><strong>03b_yeast_growth_in_chain</strong></a><br>
Topics: Running yeast growth assay for a number of plates, filtering, generating screen hit matrix, plotting all the plates in the screen.     </li>
</ul>
<ul>
<li><a href="https://github.com/disc04/simplydrug/blob/master/hts_notebooks/03c_yeast_cherry_picking.ipynb"><strong>03c_yeast_cherry_picking</strong></a><br>
Topics: Running yeast growth assay with different doses of the compounds. Generation of automatic ppt report.</li>
</ul>
<ul>
<li><a href="https://github.com/disc04/simplydrug/blob/master/hts_notebooks/04a_imaging_screen.ipynb"><strong>04a_imaging_screen</strong></a><br>
Topics: High-content screening and image analysis, reporter system, cell viability, systematic errors detection and correction. </li>
</ul>
<ul>
<li><a href="https://github.com/disc04/blob/master/simplydrug/hts_notebooks/4b_imaging_assay_development.ipynb"><strong>4b_imaging_assay_development</strong></a><br>
Topics: Exploration data anslysdis, PCA, Batch effect.</li>
</ul>
<ul>
<li><a href="https://github.com/disc04/simplydrug/blob/master/hts_notebooks/04c_imaging_dose_response.ipynb"><strong>04c_imaging_dose_response</strong> </a><br>
Topics: Activity versus viability, fitting dose-response for imaging data. </li>
</ul>
<ul>
<li><a href="https://github.com/disc04/simplydrug/blob/master/hts_notebooks/05_xtt_assay.ipynb"><strong>05_xtt_assay</strong></a><br>
Dose-response assay for compound toxicity.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Install">Install<a class="anchor-link" href="#Install"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are several options:</p>
<ol>
<li>Run the notebooks from Binder    </li>
</ol>
<p><a href="https://mybinder.org/v2/gh/disc04/simplydrug/master"><img src="https://img.shields.io/badge/Binder%20Launch:-simplydrug-blue.svg?colorA=&amp;logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH4gsEADkvyr8GjAAABQZJREFUSMeVlnlsVFUUh7/7ZukwpQxdoK2yGGgqYFKMQkyDUVBZJECQEERZVLQEa4iKiggiFjfqbkADhVSgEVkETVSiJBATsEIRja1RoCwuU5gC7Qww03Zm3rzrH/dOfJSZUm4y6Xt9957vnnN/55wruI7RVjMNQAA3AiX6bxw4BTQAQQDvnF1pbYjrAAEUAmXADGAQ0AOQwCWgHqgGdgCRdNBrAm2wW4A1wN2ACZwG/gbcQBFwg/Z2I/AS0JoKanQzmoXAamA0cBx4EhgDTAYmAvcArwNhYD6wHHDbNts9D20LlgMrgWPAXKAO/j8rPc8A5uiNAUwH9tjnddfDAn1mFkJWyoRR58hsv8KIfraAz/QvC3golf2UwEBZBYGyCoJfj/LFz/ceDxRJ09Hccbz/6dDu0ozg7lICZRVXrNFQEyWaDmAkkNslMAnSE59x9IrsMVt8awBP4rI3P9acs83hC3+BkFMAd2eoHn8BrdpG77RA2+IiYDPwHnAbEAOkMGQMcAKTdNheBXqmgDoBhw6xda2Q9tGHPhE4hRTlrrxQGRB29IqE3IUtTyDFu9rQC8AiwAiUVdgFNhTIA85oT68G2nb5ODABJf25niL/emfexX1AA0IWeIr8xWbY+yKwBJVzC4FSm71MlFIdwH505UnnYT5KWRawCvgp0eYBCKEqSBwpFuVMqp2a5Q1WO6TcakiZ55DWwyVVKxDC8gLPA1OAJh32q8qcHTgEKEbl2ncAua99lPy2FdgskH2FlFXNI8IVewcO8P+WUyjr8vqPfmvt+plhmVltIJeilLoK+CWVopy250LAgyrELcl/9nB/ixkbF3GKyOJ/rJs8hxNDZx1KDFvsz+9jJvINAQz1EKvxR7OddzrroyXGiRV5zvp1WPlSzN7bJVCmEtKDF38khguQeR5iBRYGFoaZaUUv9YsEc+KGYfq9vssN1qDsP2MDHRZiYBRXpoEMwa1XAe3Gm4A2YDDQ1z7JTbyvG3O1hXEvcNI0xFPzTh5ZueB4HeXH6hoGR1onC2SlhQgD5RnEl7kwXTOqfu4SeBT4Q5/jVIBtL29KfnsUGAecsISY++W+mpohwQujXJYlPAnzh2HBc7Uxw1iGSpU2VAu7C6Az1A68gEr4ZI6NXT78Pkxh9JEwU4JlGsYbO3a+c7g50/esFGIqcBb4fEzgNBlWwgI2AVsAH13V0oL1K5LvNcBOYACwsfb7qiX3n2mcmGXGirPjHf8uPHqw/Xy/IeuAV/TG3gaOAGyfPwJUbm4HosAdpKilzk7vIVT1iAPTTWG8Of5MY/vIFn8Pt2UVZkfbqi0hvFrFlcBaQNo2DKoxt6CqjQ84nzKktkV+YIE+hz1OaUVyou0iKx41BAR02KYB7wMdnWBJm4aOgOz8MWUDTpa6/NazGdUlo8c2ZuVukdBWfOnCtHlffXAwdPsEK2o47Ju0i2MysAt1xxkLtOpwpwzpFd4+sOHXKHDAIa16YNTJrJzS3x9ZVdvoy+WbecNTLfUCs7Xd/aQr3umGy0rgshIhQ8pNhpSmIeVzTZm9pnjNuLDLXT97gKdRKXUWXUvt3qUNqX1oYz2Bj1H3mXPABh22JlRnuBl4DHWPAVgKfAjIzkDntYB6hIHFKPXO0gbLUQp0oO49Xv1eCXySCtYtDzt56kU159moQulDqfEccAD4FDgEJFLBrgtog4I6r36oG0IC1d0DqNZEOhjAfzgw6LulUF3CAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE4LTExLTA0VDAwOjU3OjQ3LTA0OjAwLtN9UwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOC0xMS0wNFQwMDo1Nzo0Ny0wNDowMF+Oxe8AAAAASUVORK5CYII=" alt="Binder"></a></p>
<ol>
<li><p>pip install simplydrug</p>
</li>
<li><p>Clone this repository: git clone <a href="https://github.com/disc04/simplydrug">https://github.com/disc04/simplydrug</a></p>
</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Dependencies">Dependencies<a class="anchor-link" href="#Dependencies"> </a></h2><p>The codebase relies on the following dependencies (tested version provided in parentheses):</p>
<ul>
<li>python (3.6.1)</li>
<li>pubchempy (1.0.4)</li>
<li>scipy (1.4.1)</li>
<li>seaborn (0.10.0)</li>
<li>python-pptx (0.6.18)</li>
<li>wget(3.2)</li>
<li>xlrd (1.2.0)</li>
<li>rdkit (2019.09.3)</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example-usage">Example usage<a class="anchor-link" href="#Example-usage"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div align="justify"> In each experiment, first, we merge numerical data coming from equipment with the plate layout (descriptors). We describe the experimental design in a layout excel file, and the names of the excel sheets become the names of the columns in a final data table. Each excel sheet contains a table with dimensions of the experiment plate (usually 96 or 384-well plates) and represents some aspect of the layout  -  well ID, treatment, cell density, compound ID, compound concentration, etc.</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div align="justify"> The layout file must contain sheets named  'Well' and 'Status'. The 'Well' table lists well IDs, and the 'Status' can contain either 'Sample', 'Positive' or 'Negative' control, or 'Reference' values. 'Reference' wells are excluded from calculations. The function add_layout merges measurements and layout by the 'Well' column.</div>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">simplydrug.core</span> <span class="k">as</span> <span class="nn">sd</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">(</span><span class="s1">&#39;hts_notebooks//hts_data//enzyme_kinetics_data1.xlsx&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="mi">0</span><span class="p">))[[</span><span class="s1">&#39;Well&#39;</span><span class="p">,</span><span class="s1">&#39;0s&#39;</span><span class="p">,</span><span class="s1">&#39;120s&#39;</span><span class="p">,</span><span class="s1">&#39;240s&#39;</span><span class="p">,</span> <span class="s1">&#39;360s&#39;</span><span class="p">]]</span>
<span class="n">layout_path</span> <span class="o">=</span> <span class="s1">&#39;hts_notebooks//hts_data//enzyme_kinetics_layout.xlsx&#39;</span>
<span class="n">chem_path</span> <span class="o">=</span> <span class="s1">&#39;hts_notebooks//hts_data//compounds//example_chemicals.csv&#39;</span>
<span class="n">chem_plate</span> <span class="o">=</span> <span class="s1">&#39;ex_plate1&#39;</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">sd</span><span class="o">.</span><span class="n">add_layout</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">layout_path</span><span class="p">,</span> <span class="n">chem_path</span> <span class="o">=</span> <span class="n">chem_path</span><span class="p">,</span> <span class="n">chem_plate</span> <span class="o">=</span> <span class="n">chem_plate</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div>
<p><img src="./hts_notebooks/hts_images/index_df.png" style="vertical-align:left margin:50px 50px" width="650"/></p>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To check our 384 well plate for systematic errors, we often use heatmap representation:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sd</span><span class="o">.</span><span class="n">hts_heatmap</span><span class="p">(</span><span class="n">df</span> <span class="o">=</span> <span class="n">results</span><span class="p">,</span> <span class="n">layout_path</span> <span class="o">=</span> <span class="n">layout_path</span><span class="p">,</span> <span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;120s&#39;</span><span class="p">],</span> <span class="n">path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div>
<p><img src="./hts_notebooks/hts_images/index_heatmap.png" style="vertical-align:left margin:50px 50px" width="300"/></p>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div align="justify"> In this plate, most of the readings across the plate are close to the plate average, and four wells with high readings probably represent our hit compounds.</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Functionality">Functionality<a class="anchor-link" href="#Functionality"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="exception_handler" class="doc_header"><code>exception_handler</code><a href="https://github.com/disc04/simplydrug/tree/master/simplydrug/core.py#L9" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>exception_handler</code>(<strong><code>func</code></strong>)</p>
</blockquote>
<p>Exception handler helper function.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="add_layout" class="doc_header"><code>add_layout</code><a href="https://github.com/disc04/simplydrug/tree/master/simplydrug/core.py#L22" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>add_layout</code>(<strong><code>df</code></strong>=<em><code>None</code></em>, <strong><code>layout_path</code></strong>=<em><code>None</code></em>, <strong><code>chem_path</code></strong>=<em><code>None</code></em>, <strong><code>chem_plate</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Add_layout function updates DataFrame containing measurements with descriptors columns taken from plate layout excel file.
Sheet names in the layout file are translated to column names in the updated DataFrame.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div align="justify">Add_layout function takes DataFrame, the path to layout excel file, the path to chemical library and plate name, and returns an updated DataFrame with added layout columns. We use a layout excel file to describe the experimental design, and the names of the excel sheets become the names of the columns in a final data table. Each excel sheet contains a table with dimensions of the experiment plate (usually 96 or 384-well plates) and represents some aspect of the layout - well ID, treatment, cell density, compound ID, compound concentration, etc.
The layout file must contain sheets named 'Well' and 'Status'. The 'Well' table lists well IDs, and the 'Status' can contain either 'Sample', 'Positive' or 'Negative' control, or 'Reference' values. 'Reference' wells are excluded from calculations. The function add_layout merges measurements and layout by the 'Well' column.
</div>

<div>
<p><img src="./hts_notebooks/hts_images/layout.png" style="vertical-align:left margin:50px 50px" width="650"/></p>
</div>
<div align="justify"> Next, we need to import compound ids from chemical library. There are two options. We can fill compound ids manually in the layout excel, or we can give to the function the plate name from defined library. In this module, we will use example_chemicals.csv file located in hts_data/compounds. The name of the library is 'example_library', it contains random compounds divided into 3 plates: 'ex_plate1', 'ex_plate2', and 'ex_plate3'
For example, to load compounds from plate 3 of the library, we will pass to the function chem_path = 'hts_data//compounds//example_chemicals.csv, and chem_plate = 'ex_plate3'.
</div>
<div>
</div>
<p><img src="./hts_notebooks/hts_images/chemlib.png" style="vertical-align:left margin:50px 50px" width="600"/></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Quality-control">Quality control<a class="anchor-link" href="#Quality-control"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Order-wells">Order wells<a class="anchor-link" href="#Order-wells"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="order_wells" class="doc_header"><code>order_wells</code><a href="https://github.com/disc04/simplydrug/tree/master/simplydrug/core.py#L47" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>order_wells</code>(<strong><code>x</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Orders wells as they aappear in the plate. For example, converts ['A10', 'A11', 'A12', 'A1', 'A2'] to ['A1', 'A2', 'A10', 'A11', 'A12']. </p>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}


<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Heatmap">Heatmap<a class="anchor-link" href="#Heatmap"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="hts_heatmap" class="doc_header"><code>hts_heatmap</code><a href="https://github.com/disc04/simplydrug/tree/master/simplydrug/core.py#L56" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>hts_heatmap</code>(<strong><code>df</code></strong>=<em><code>None</code></em>, <strong><code>layout_path</code></strong>=<em><code>None</code></em>, <strong><code>features</code></strong>=<em><code>None</code></em>, <strong><code>save_as</code></strong>=<em><code>None</code></em>, <strong><code>path</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Takes DataFrame, list of features, a path to layout file, and the output folder and creates a plate heatmap for the input features.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Summary-statistics">Summary statistics<a class="anchor-link" href="#Summary-statistics"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="sum_statistics" class="doc_header"><code>sum_statistics</code><a href="https://github.com/disc04/simplydrug/tree/master/simplydrug/core.py#L110" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>sum_statistics</code>(<strong><code>df</code></strong>=<em><code>None</code></em>, <strong><code>feature</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Takes DataFrame and calculates summary statistics for the experiment. The data must contain the 'Status' column, defining each row as 'Sample', 'Positive' or 'Negative' control, or 'Reference'.  'Reference' wells are excluded from the analysis.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Z-score-normalization">Z-score normalization<a class="anchor-link" href="#Z-score-normalization"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="normalize_z" class="doc_header"><code>normalize_z</code><a href="https://github.com/disc04/simplydrug/tree/master/simplydrug/core.py#L134" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>normalize_z</code>(<strong><code>df</code></strong>=<em><code>None</code></em>, <strong><code>feature</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Takes DataFrame with measurements and feature name and adds a column with normalized values of the feature.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="histogram_feature" class="doc_header"><code>histogram_feature</code><a href="https://github.com/disc04/simplydrug/tree/master/simplydrug/core.py#L144" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>histogram_feature</code>(<strong><code>df</code></strong>=<em><code>None</code></em>, <strong><code>feature</code></strong>=<em><code>None</code></em>, <strong><code>save_as</code></strong>=<em><code>None</code></em>, <strong><code>path</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Creates histogram of the input feature.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Growth-score-functions">Growth score functions<a class="anchor-link" href="#Growth-score-functions"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="calculate_growth_score" class="doc_header"><code>calculate_growth_score</code><a href="https://github.com/disc04/simplydrug/tree/master/simplydrug/core.py#L162" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>calculate_growth_score</code>(<strong><code>df</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Calculates growth scores from time series data. Takes pandas DataFrame with time-series data and returns DataFrame with growth scores.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><div align="justify"> This function used to calculate Growth Scores from time-series data. The Growth Score is defined by three parameters of the Zwietering (Zwietering et al., 1990) bacterial growth curve - the starting absorbance y0, biomass yield  A, and the maximum growth rate μ:
</div></p>
<div align="justify">  


<pre><code>                                 GS = (A − y0) + 0.25μ  
</code></pre>
<div align="justify"> 
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="filter_curves" class="doc_header"><code>filter_curves</code><a href="https://github.com/disc04/simplydrug/tree/master/simplydrug/core.py#L188" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>filter_curves</code>(<strong><code>df</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Filter out aberrant curves.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div align="justify"> This function filters out aberrant (broken) growth curves from the experiment if the curve starts at unreasonable high value or if the curve shows sudden drops.</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Dose-response">Dose-response<a class="anchor-link" href="#Dose-response"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ll4" class="doc_header"><code>ll4</code><a href="https://github.com/disc04/simplydrug/tree/master/simplydrug/core.py#L213" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ll4</code>(<strong><code>x</code></strong>, <strong><code>b</code></strong>, <strong><code>c</code></strong>, <strong><code>d</code></strong>, <strong><code>e</code></strong>)</p>
</blockquote>
<p>Dose-response function - LM equation, LL.4 function (4-parameter sigmoidal function).</p>
<ul>
<li>b: hill slope</li>
<li>c: min response</li>
<li>d: max response</li>
<li>e: EC50</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="inv_log" class="doc_header"><code>inv_log</code><a href="https://github.com/disc04/simplydrug/tree/master/simplydrug/core.py#L225" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>inv_log</code>(<strong><code>x</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Inverse log calculator</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="pDose" class="doc_header"><code>pDose</code><a href="https://github.com/disc04/simplydrug/tree/master/simplydrug/core.py#L230" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>pDose</code>(<strong><code>x</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Helper function, used to compute log transformed concentrations.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="dose_response" class="doc_header"><code>dose_response</code><a href="https://github.com/disc04/simplydrug/tree/master/simplydrug/core.py#L236" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>dose_response</code>(<strong><code>df</code></strong>=<em><code>None</code></em>, <strong><code>y_label</code></strong>=<em><code>'Response'</code></em>, <strong><code>path</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Dose response function. The input DataFrame should contain columns 'Compound_id', 'Dose', 'Response'.
The DataFrame shouldn't contain NAN values or dose 0, which will result in infinity at logDose.
The fitting function is a LL.4 function (4-parameter sigmoidal function) with</p>
<ul>
<li>b: hill slope</li>
<li>c: min response</li>
<li>d: max response</li>
<li>e: EC50</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plot_dr_viability" class="doc_header"><code>plot_dr_viability</code><a href="https://github.com/disc04/simplydrug/tree/master/simplydrug/core.py#L316" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plot_dr_viability</code>(<strong><code>data</code></strong>=<em><code>None</code></em>, <strong><code>y_label</code></strong>=<em><code>'Response'</code></em>, <strong><code>path</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Plots response vs viability. The DataFrame should contain columns ['Compound', 'Dose','logDose', 'Viability', 'Response'] (at least).</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="prune_compound" class="doc_header"><code>prune_compound</code><a href="https://github.com/disc04/simplydrug/tree/master/simplydrug/core.py#L367" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>prune_compound</code>(<strong><code>df</code></strong>, <strong><code>threshold</code></strong>=<em><code>-0.15</code></em>)</p>
</blockquote>
<p>This function takes DataFrame of one-compound dose-response data, find maximum activity,
 and drops rows starting from treshold-defined reduction of Response. The default value for threshold = -0.15,
it drops rows starting from 15% reduction of Response. The input DataFrame should contain columns
'Compound_id', 'Dose', 'Response'.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plot_polynomial" class="doc_header"><code>plot_polynomial</code><a href="https://github.com/disc04/simplydrug/tree/master/simplydrug/core.py#L387" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plot_polynomial</code>(<strong><code>df</code></strong>=<em><code>None</code></em>, <strong><code>y_label</code></strong>=<em><code>'Response'</code></em>, <strong><code>degree</code></strong>=<em><code>2</code></em>, <strong><code>path</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Plot polynomial fit.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Plots">Plots<a class="anchor-link" href="#Plots"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plot_treatments" class="doc_header"><code>plot_treatments</code><a href="https://github.com/disc04/simplydrug/tree/master/simplydrug/core.py#L433" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plot_treatments</code>(<strong><code>df</code></strong>=<em><code>None</code></em>, <strong><code>x</code></strong>=<em><code>None</code></em>, <strong><code>y</code></strong>=<em><code>None</code></em>, <strong><code>column</code></strong>=<em><code>None</code></em>, <strong><code>kind</code></strong>=<em><code>None</code></em>, <strong><code>ylabel</code></strong>=<em><code>None</code></em>, <strong><code>palette</code></strong>=<em><code>None</code></em>, <strong><code>height</code></strong>=<em><code>None</code></em>, <strong><code>aspect</code></strong>=<em><code>None</code></em>, <strong><code>save_as</code></strong>=<em><code>None</code></em>, <strong><code>path</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Creates plot by treatments. If your data has different treatments, set column = 'Treatment'.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plot_curve_raw" class="doc_header"><code>plot_curve_raw</code><a href="https://github.com/disc04/simplydrug/tree/master/simplydrug/core.py#L455" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plot_curve_raw</code>(<strong><code>df</code></strong>=<em><code>None</code></em>, <strong><code>x</code></strong>=<em><code>None</code></em>, <strong><code>y</code></strong>=<em><code>None</code></em>, <strong><code>units</code></strong>=<em><code>None</code></em>, <strong><code>hue</code></strong>=<em><code>None</code></em>, <strong><code>hue_order</code></strong>=<em><code>None</code></em>, <strong><code>xlabel</code></strong>=<em><code>None</code></em>, <strong><code>ylabel</code></strong>=<em><code>None</code></em>, <strong><code>xlimit</code></strong>=<em><code>None</code></em>, <strong><code>palette</code></strong>=<em><code>None</code></em>, <strong><code>save_as</code></strong>=<em><code>None</code></em>, <strong><code>path</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Plots raw kinetic curves.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plot_curve_mean" class="doc_header"><code>plot_curve_mean</code><a href="https://github.com/disc04/simplydrug/tree/master/simplydrug/core.py#L478" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plot_curve_mean</code>(<strong><code>df</code></strong>=<em><code>None</code></em>, <strong><code>x</code></strong>=<em><code>None</code></em>, <strong><code>y</code></strong>=<em><code>None</code></em>, <strong><code>hue</code></strong>=<em><code>None</code></em>, <strong><code>hue_order</code></strong>=<em><code>None</code></em>, <strong><code>xlabel</code></strong>=<em><code>None</code></em>, <strong><code>ylabel</code></strong>=<em><code>None</code></em>, <strong><code>xlimit</code></strong>=<em><code>None</code></em>, <strong><code>palette</code></strong>=<em><code>None</code></em>, <strong><code>save_as</code></strong>=<em><code>None</code></em>, <strong><code>path</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Plots mean kinetic curves.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="pointplot_plate" class="doc_header"><code>pointplot_plate</code><a href="https://github.com/disc04/simplydrug/tree/master/simplydrug/core.py#L501" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>pointplot_plate</code>(<strong><code>df</code></strong>=<em><code>None</code></em>, <strong><code>x</code></strong>=<em><code>None</code></em>, <strong><code>y</code></strong>=<em><code>None</code></em>, <strong><code>hue</code></strong>=<em><code>None</code></em>, <strong><code>hue_order</code></strong>=<em><code>None</code></em>, <strong><code>threshold</code></strong>=<em><code>None</code></em>, <strong><code>ylabel</code></strong>=<em><code>None</code></em>, <strong><code>palette</code></strong>=<em><code>None</code></em>, <strong><code>save_as</code></strong>=<em><code>None</code></em>, <strong><code>path</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Creates point plot for the experiment.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Reporting">Reporting<a class="anchor-link" href="#Reporting"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="df_to_table" class="doc_header"><code>df_to_table</code><a href="https://github.com/disc04/simplydrug/tree/master/simplydrug/core.py#L526" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>df_to_table</code>(<strong><code>df</code></strong>=<em><code>None</code></em>, <strong><code>slide</code></strong>=<em><code>None</code></em>, <strong><code>left</code></strong>=<em><code>None</code></em>, <strong><code>top</code></strong>=<em><code>None</code></em>, <strong><code>width</code></strong>=<em><code>None</code></em>, <strong><code>height</code></strong>=<em><code>None</code></em>, <strong><code>colnames</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Converts a Pandas DataFrame to a PowerPoint table on the given slide of a PowerPoint presentation.
The table is a standard Powerpoint table, and can easily be modified with the Powerpoint tools (resizing columns, changing formatting etc).
Source:  <a href="https://github.com/robintw/PandasToPowerpoint/blob/master/PandasToPowerpoint.py">https://github.com/robintw/PandasToPowerpoint/blob/master/PandasToPowerpoint.py</a></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_presentation" class="doc_header"><code>create_presentation</code><a href="https://github.com/disc04/simplydrug/tree/master/simplydrug/core.py#L563" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_presentation</code>(<strong><code>path</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Creates ppt report from files in the specified folder.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Copyright">Copyright<a class="anchor-link" href="#Copyright"> </a></h2>
<p>Copyright 2020 onwards, Blavatnik Center for Drug Discovery. Licensed under the Apache License, Version 2.0 (the "License"); you may not use this project's files except in compliance with the License. A copy of the License is provided in the LICENSE file in this repository.
</p>

</div>
</div>
</div>
</div>
 
 
